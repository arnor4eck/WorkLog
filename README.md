# WorkLog

Приложение на Java Spring Boot для хакатона ["Лидеры цифровой трансформации"](https://i.moscow/lct).

## Роли пользователей
Приложение подразумевает пользователей с 5 возможными ролями:

1. `ROLE_CONTRACTOR (сокр. contractor)` - подрядчик
2. `ROLE_SUPERVISION (сокр. supervision)` - технический надзор, следит за выполнением работы и контролирует соблюдение всех норм
3. `ROLE_INSPECTOR (сокр. inspector)` - государственная инспекция
4. `ROLE_DEVELOPER (сокр. developer)` - застройщик
5. `ROLE_ADMIN (сокр. admin)` - доступ к админ-панели

## Описание работы

После заключения контракта **заказчик** (`ROLE_DEVELOPER`) составляет пообъектно график производства работ.
График представляет собой диаграмму Ганта, в котором указаны виды работ и даты выполнения. Все документы согласованы между **заказчиком** и **подрядчиком** (`ROLE_CONTRACTOR`).

Ежедневно (согласно плану работ) на объект поставляется необходимый материал и со стороны **подрядчика** происходит входной контроль материала на объекте.
Для автоматизации входного контроля участникам предлагается использовать компьютерное зрение для получения данных из товарно-транспортной накладной (ТТН) с возможностью прикрепить фотографию дополнительных документов на материал.

Параллельно с выполнением работ и поставкой материалов объект благоустройства посещает **служба строительного контроля** заказчика (`ROLE_SUPERVISION`), которой видна динамика производства работ на объекте.
Также **служба строительного контроля** может вносить замечания о качестве производства работ и ставить срок их устранения.

Помимо **прораба** и **служб строительного контроля** заказчика объект также посещают к**онтрольные органы** (`ROLE_INSPECTOR`), которые могут выявлять нарушения требований нормативной документации, фиксировать количество рабочей силы и техники на объекте и выдавать предписания для устранения нарушений.

Объем информации, вносимой в сервис различными структурами и участниками процесса благоустройства, позволяет:
1. Отслеживать  строительную готовность объекта;
2. Мониторить вносимые замечания и нарушения различными структурами;
3. Собирать общую информацию по работе на строительной площадке, включая даты посещения объекта всеми участниками процесса благоустройства;

# Запуск приложения

- **Первый шаг**

    Скопируйте содержимое репозитория на рабочий стол:
    
    ```bash
    git clone https://github.com/arnor4eck/WorkLog.git
    ```

- **Второй шаг**

    Откройте терминал из скопированной папки и пропишите команду для сборки:
    
    ```bash
    ./gradlew build -x test
    ```

- **Третий шаг**

  Пропишите команду для старта приложения:

    ```bash
    ./gradlew bootRun
    ```

- **Документация**
    
    Для создания документации пропишите команду:

    ```bash
    ./gradlew javadoc -quiet
    ```
  
    Пропишите команду:
    
    ```bash
    build/docs/javadoc/com/arnor4eck/worklog/package-summary.html
    ```

# Пути

## Авторизация

### Вход в аккаунт

- `POST /auth/`
- Производит вход в аккаунт
- Возвращает JWT-токен

````json
{
    "email": "vladi52@ngg.com",
    "password": "password"
}
````

## Объекты

### Создание объекта

- `POST /objects/`
- Создает новый полигон

```json
{
  "name": "ЖК Комфорт",
  "description": "Многоэтажный жилой комплекс",
  "coordinates": [
    [75.584385734876, 1.57348573486],
    [23.5867585734876, 52.546373]
  ],
  "users": [1,2,3],
  "contractor": 1,
  "supervision": 3
}
```

### Получение объектов, к которым привязан пользователь

- `GET /objects/my_objects/`
- Возвращает все объекты, к которым привязан пользователь

```json
[
  {
    "id": 1,
    "name": "project_1",
    "description": "test project",
    "coordinates": [
      {
        "x": 24.5734563746,
        "y": 56.5617325627
      },
      {
        "x": 434.5734563746,
        "y": 436.5617325627
      }
    ],
    "responsibleContractor": {
      "username": "vladi",
      "position": "Технический контроль",
      "email": "kura@jam.com"
    },
    "responsibleSupervision": {
      "username": "berenby",
      "position": "застройщик",
      "email": "bere@mail.ru"
    }
  }
]
```

### Получение объекта по ID

- `GET /objects/{id}/`
- Получение объекта по ID
- Нельзя получить, если пользователь не прикреплен к нему

```json
{
    "id": 1,
    "name": "project_1",
    "description": "test project",
    "coordinates": [
        {
            "x": 24.5734563746,
            "y": 56.5617325627
        },
        {
            "x": 434.5734563746,
            "y": 436.5617325627
        }
    ],
    "responsibleContractor": {
        "username": "vladi",
        "position": "Технический контроль",
        "email": "kura@jam.com"
    },
    "responsibleSupervision": {
        "username": "berenby",
        "position": "застройщик",
        "email": "bere@mail.ru"
    }
}
```

### Создание поста

- `POST /objects/{object_id}/create_post/?title=title&content=content&author=author&files=files`
- Создает пост, привязанный к конкретному полигону

```json
{
    "title": "goooooool",
    "content": "gfejwhbgkjsebgkusehg",
    "author": 1,
    "files": []
}
```

### Получение поста по ID

- `GET /objects/{object_id}/{post_id}/`
- Возвращает пост

```json
{
    "id": 4,
    "title": "gooooool",
    "content": "rhgjrehgjrhjer",
    "createdAt": "29/09/2025 [15:39]",
    "files": [
        "GigaChatAPI_com.arnor4eck_01998c49-00f6-71ba-99a3-0c67609adb5b_2025-09-01_2025-09-28.xlsx"
    ],
    "author": {
        "username": "vladi",
        "position": "Прораб",
        "email": "vladi52@ngg.com"
    }
}
```

### Получение файла из поста

- `GET /objects/{object_id}/{post_id}/file/?file_name=name`
- Возвращает файл поста

## Структура базы данных

[Ссылка на dbdiagram](https://dbdiagram.io/d/WorkLog-67dc537875d75cc844dea298)